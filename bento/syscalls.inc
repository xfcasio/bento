;; x86_64 (64 bit) ;;
SYSCALL_READ equ 0x00
SYSCALL_WRITE equ 0x01
SYSCALL_OPEN equ 0x02
SYSCALL_CLOSE equ 0x03
SYSCALL_STAT equ 0x04
SYSCALL_FSTAT equ 0x05
SYSCALL_LSTAT equ 0x06
SYSCALL_POLL equ 0x07
SYSCALL_LSEEK equ 0x08
SYSCALL_MMAP equ 0x09
SYSCALL_MPROTECT equ 0x0a
SYSCALL_MUNMAP equ 0x0b
SYSCALL_BRK equ 0x0c
SYSCALL_RT_SIGACTION equ 0x0d
SYSCALL_RT_SIGPROCMASK equ 0x0e
SYSCALL_RT_SIGRETURN equ 0x0f
SYSCALL_IOCTL equ 0x10
SYSCALL_PREAD64 equ 0x11
SYSCALL_PWRITE64 equ 0x12
SYSCALL_READV equ 0x13
SYSCALL_WRITEV equ 0x14
SYSCALL_ACCESS equ 0x15
SYSCALL_PIPE equ 0x16
SYSCALL_SELECT equ 0x17
SYSCALL_SCHED_YIELD equ 0x18
SYSCALL_MREMAP equ 0x19
SYSCALL_MSYNC equ 0x1a
SYSCALL_MINCORE equ 0x1b
SYSCALL_MADVISE equ 0x1c
SYSCALL_SHMGET equ 0x1d
SYSCALL_SHMAT equ 0x1e
SYSCALL_SHMCTL equ 0x1f
SYSCALL_DUP equ 0x20
SYSCALL_DUP2 equ 0x21
SYSCALL_PAUSE equ 0x22
SYSCALL_NANOSLEEP equ 0x23
SYSCALL_GETITIMER equ 0x24
SYSCALL_ALARM equ 0x25
SYSCALL_SETITIMER equ 0x26
SYSCALL_GETPID equ 0x27
SYSCALL_SENDFILE equ 0x28
SYSCALL_SOCKET equ 0x29
SYSCALL_CONNECT equ 0x2a
SYSCALL_ACCEPT equ 0x2b
SYSCALL_SENDTO equ 0x2c
SYSCALL_RECVFROM equ 0x2d
SYSCALL_SENDMSG equ 0x2e
SYSCALL_RECVMSG equ 0x2f
SYSCALL_SHUTDOWN equ 0x30
SYSCALL_BIND equ 0x31
SYSCALL_LISTEN equ 0x32
SYSCALL_GETSOCKNAME equ 0x33
SYSCALL_GETPEERNAME equ 0x34
SYSCALL_SOCKETPAIR equ 0x35
SYSCALL_SETSOCKOPT equ 0x36
SYSCALL_GETSOCKOPT equ 0x37
SYSCALL_CLONE equ 0x38
SYSCALL_FORK equ 0x39
SYSCALL_VFORK equ 0x3a
SYSCALL_EXECVE equ 0x3b
SYSCALL_EXIT equ 0x3c
SYSCALL_WAIT4 equ 0x3d
SYSCALL_KILL equ 0x3e
SYSCALL_UNAME equ 0x3f
SYSCALL_SEMGET equ 0x40
SYSCALL_SEMOP equ 0x41
SYSCALL_SEMCTL equ 0x42
SYSCALL_SHMDT equ 0x43
SYSCALL_MSGGET equ 0x44
SYSCALL_MSGSND equ 0x45
SYSCALL_MSGRCV equ 0x46
SYSCALL_MSGCTL equ 0x47
SYSCALL_FCNTL equ 0x48
SYSCALL_FLOCK equ 0x49
SYSCALL_FSYNC equ 0x4a
SYSCALL_FDATASYNC equ 0x4b
SYSCALL_TRUNCATE equ 0x4c
SYSCALL_FTRUNCATE equ 0x4d
SYSCALL_GETDENTS equ 0x4e
SYSCALL_GETCWD equ 0x4f
SYSCALL_CHDIR equ 0x50
SYSCALL_FCHDIR equ 0x51
SYSCALL_RENAME equ 0x52
SYSCALL_MKDIR equ 0x53
SYSCALL_RMDIR equ 0x54
SYSCALL_CREAT equ 0x55
SYSCALL_LINK equ 0x56
SYSCALL_UNLINK equ 0x57
SYSCALL_SYMLINK equ 0x58
SYSCALL_READLINK equ 0x59
SYSCALL_CHMOD equ 0x5a
SYSCALL_FCHMOD equ 0x5b
SYSCALL_CHOWN equ 0x5c
SYSCALL_FCHOWN equ 0x5d
SYSCALL_LCHOWN equ 0x5e
SYSCALL_UMASK equ 0x5f
SYSCALL_GETTIMEOFDAY equ 0x60
SYSCALL_GETRLIMIT equ 0x61
SYSCALL_GETRUSAGE equ 0x62
SYSCALL_SYSINFO equ 0x63
SYSCALL_TIMES equ 0x64
SYSCALL_PTRACE equ 0x65
SYSCALL_GETUID equ 0x66
SYSCALL_SYSLOG equ 0x67
SYSCALL_GETGID equ 0x68
SYSCALL_SETUID equ 0x69
SYSCALL_SETGID equ 0x6a
SYSCALL_GETEUID equ 0x6b
SYSCALL_GETEGID equ 0x6c
SYSCALL_SETPGID equ 0x6d
SYSCALL_GETPPID equ 0x6e
SYSCALL_GETPGRP equ 0x6f
SYSCALL_SETSID equ 0x70
SYSCALL_SETREUID equ 0x71
SYSCALL_SETREGID equ 0x72
SYSCALL_GETGROUPS equ 0x73
SYSCALL_SETGROUPS equ 0x74
SYSCALL_SETRESUID equ 0x75
SYSCALL_GETRESUID equ 0x76
SYSCALL_SETRESGID equ 0x77
SYSCALL_GETRESGID equ 0x78
SYSCALL_GETPGID equ 0x79
SYSCALL_SETFSUID equ 0x7a
SYSCALL_SETFSGID equ 0x7b
SYSCALL_GETSID equ 0x7c
SYSCALL_CAPGET equ 0x7d
SYSCALL_CAPSET equ 0x7e
SYSCALL_RT_SIGPENDING equ 0x7f
SYSCALL_RT_SIGTIMEDWAIT equ 0x80
SYSCALL_RT_SIGQUEUEINFO equ 0x81
SYSCALL_RT_SIGSUSPEND equ 0x82
SYSCALL_SIGALTSTACK equ 0x83
SYSCALL_UTIME equ 0x84
SYSCALL_MKNOD equ 0x85
SYSCALL_USELIB equ 0x86
SYSCALL_PERSONALITY equ 0x87
SYSCALL_USTAT equ 0x88
SYSCALL_STATFS equ 0x89
SYSCALL_FSTATFS equ 0x8a
SYSCALL_SYSFS equ 0x8b
SYSCALL_GETPRIORITY equ 0x8c
SYSCALL_SETPRIORITY equ 0x8d
SYSCALL_SCHED_SETPARAM equ 0x8e
SYSCALL_SCHED_GETPARAM equ 0x8f
SYSCALL_SCHED_SETSCHEDULER equ 0x90
SYSCALL_SCHED_GETSCHEDULER equ 0x91
SYSCALL_SCHED_GET_PRIORITY_MAX equ 0x92
SYSCALL_SCHED_GET_PRIORITY_MIN equ 0x93
SYSCALL_SCHED_RR_GET_INTERVAL equ 0x94
SYSCALL_MLOCK equ 0x95
SYSCALL_MUNLOCK equ 0x96
SYSCALL_MLOCKALL equ 0x97
SYSCALL_MUNLOCKALL equ 0x98
SYSCALL_VHANGUP equ 0x99
SYSCALL_MODIFY_LDT equ 0x9a
SYSCALL_PIVOT_ROOT equ 0x9b
SYSCALL__SYSCTL equ 0x9c
SYSCALL_PRCTL equ 0x9d
SYSCALL_ARCH_PRCTL equ 0x9e
SYSCALL_ADJTIMEX equ 0x9f
SYSCALL_SETRLIMIT equ 0xa0
SYSCALL_CHROOT equ 0xa1
SYSCALL_SYNC equ 0xa2
SYSCALL_ACCT equ 0xa3
SYSCALL_SETTIMEOFDAY equ 0xa4
SYSCALL_MOUNT equ 0xa5
SYSCALL_UMOUNT2 equ 0xa6
SYSCALL_SWAPON equ 0xa7
SYSCALL_SWAPOFF equ 0xa8
SYSCALL_REBOOT equ 0xa9
SYSCALL_SETHOSTNAME equ 0xaa
SYSCALL_SETDOMAINNAME equ 0xab
SYSCALL_IOPL equ 0xac
SYSCALL_IOPERM equ 0xad
SYSCALL_CREATE_MODULE equ 0xae
SYSCALL_INIT_MODULE equ 0xaf
SYSCALL_DELETE_MODULE equ 0xb0
SYSCALL_GET_KERNEL_SYMS equ 0xb1
SYSCALL_QUERY_MODULE equ 0xb2
SYSCALL_QUOTACTL equ 0xb3
SYSCALL_NFSSERVCTL equ 0xb4
SYSCALL_GETPMSG equ 0xb5
SYSCALL_PUTPMSG equ 0xb6
SYSCALL_AFS_SYSCALL equ 0xb7
SYSCALL_TUXCALL equ 0xb8
SYSCALL_SECURITY equ 0xb9
SYSCALL_GETTID equ 0xba
SYSCALL_READAHEAD equ 0xbb
SYSCALL_SETXATTR equ 0xbc
SYSCALL_LSETXATTR equ 0xbd
SYSCALL_FSETXATTR equ 0xbe
SYSCALL_GETXATTR equ 0xbf
SYSCALL_LGETXATTR equ 0xc0
SYSCALL_FGETXATTR equ 0xc1
SYSCALL_LISTXATTR equ 0xc2
SYSCALL_LLISTXATTR equ 0xc3
SYSCALL_FLISTXATTR equ 0xc4
SYSCALL_REMOVEXATTR equ 0xc5
SYSCALL_LREMOVEXATTR equ 0xc6
SYSCALL_FREMOVEXATTR equ 0xc7
SYSCALL_TKILL equ 0xc8
SYSCALL_TIME equ 0xc9
SYSCALL_FUTEX equ 0xca
SYSCALL_SCHED_SETAFFINITY equ 0xcb
SYSCALL_SCHED_GETAFFINITY equ 0xcc
SYSCALL_SET_THREAD_AREA equ 0xcd
SYSCALL_IO_SETUP equ 0xce
SYSCALL_IO_DESTROY equ 0xcf
SYSCALL_IO_GETEVENTS equ 0xd0
SYSCALL_IO_SUBMIT equ 0xd1
SYSCALL_IO_CANCEL equ 0xd2
SYSCALL_GET_THREAD_AREA equ 0xd3
SYSCALL_LOOKUP_DCOOKIE equ 0xd4
SYSCALL_EPOLL_CREATE equ 0xd5
SYSCALL_EPOLL_CTL_OLD equ 0xd6
SYSCALL_EPOLL_WAIT_OLD equ 0xd7
SYSCALL_REMAP_FILE_PAGES equ 0xd8
SYSCALL_GETDENTS64 equ 0xd9
SYSCALL_SET_TID_ADDRESS equ 0xda
SYSCALL_RESTART_SYSCALL equ 0xdb
SYSCALL_SEMTIMEDOP equ 0xdc
SYSCALL_FADVISE64 equ 0xdd
SYSCALL_TIMER_CREATE equ 0xde
SYSCALL_TIMER_SETTIME equ 0xdf
SYSCALL_TIMER_GETTIME equ 0xe0
SYSCALL_TIMER_GETOVERRUN equ 0xe1
SYSCALL_TIMER_DELETE equ 0xe2
SYSCALL_CLOCK_SETTIME equ 0xe3
SYSCALL_CLOCK_GETTIME equ 0xe4
SYSCALL_CLOCK_GETRES equ 0xe5
SYSCALL_CLOCK_NANOSLEEP equ 0xe6
SYSCALL_EXIT_GROUP equ 0xe7
SYSCALL_EPOLL_WAIT equ 0xe8
SYSCALL_EPOLL_CTL equ 0xe9
SYSCALL_TGKILL equ 0xea
SYSCALL_UTIMES equ 0xeb
SYSCALL_VSERVER equ 0xec
SYSCALL_MBIND equ 0xed
SYSCALL_SET_MEMPOLICY equ 0xee
SYSCALL_GET_MEMPOLICY equ 0xef
SYSCALL_MQ_OPEN equ 0xf0
SYSCALL_MQ_UNLINK equ 0xf1
SYSCALL_MQ_TIMEDSEND equ 0xf2
SYSCALL_MQ_TIMEDRECEIVE equ 0xf3
SYSCALL_MQ_NOTIFY equ 0xf4
SYSCALL_MQ_GETSETATTR equ 0xf5
SYSCALL_KEXEC_LOAD equ 0xf6
SYSCALL_WAITID equ 0xf7
SYSCALL_ADD_KEY equ 0xf8
SYSCALL_REQUEST_KEY equ 0xf9
SYSCALL_KEYCTL equ 0xfa
SYSCALL_IOPRIO_SET equ 0xfb
SYSCALL_IOPRIO_GET equ 0xfc
SYSCALL_INOTIFY_INIT equ 0xfd
SYSCALL_INOTIFY_ADD_WATCH equ 0xfe
SYSCALL_INOTIFY_RM_WATCH equ 0xff
SYSCALL_MIGRATE_PAGES equ 0x100
SYSCALL_OPENAT equ 0x101
SYSCALL_MKDIRAT equ 0x102
SYSCALL_MKNODAT equ 0x103
SYSCALL_FCHOWNAT equ 0x104
SYSCALL_FUTIMESAT equ 0x105
SYSCALL_NEWFSTATAT equ 0x106
SYSCALL_UNLINKAT equ 0x107
SYSCALL_RENAMEAT equ 0x108
SYSCALL_LINKAT equ 0x109
SYSCALL_SYMLINKAT equ 0x10a
SYSCALL_READLINKAT equ 0x10b
SYSCALL_FCHMODAT equ 0x10c
SYSCALL_FACCESSAT equ 0x10d
SYSCALL_PSELECT6 equ 0x10e
SYSCALL_PPOLL equ 0x10f
SYSCALL_UNSHARE equ 0x110
SYSCALL_SET_ROBUST_LIST equ 0x111
SYSCALL_GET_ROBUST_LIST equ 0x112
SYSCALL_SPLICE equ 0x113
SYSCALL_TEE equ 0x114
SYSCALL_SYNC_FILE_RANGE equ 0x115
SYSCALL_VMSPLICE equ 0x116
SYSCALL_MOVE_PAGES equ 0x117
SYSCALL_UTIMENSAT equ 0x118
SYSCALL_EPOLL_PWAIT equ 0x119
SYSCALL_SIGNALFD equ 0x11a
SYSCALL_TIMERFD_CREATE equ 0x11b
SYSCALL_EVENTFD equ 0x11c
SYSCALL_FALLOCATE equ 0x11d
SYSCALL_TIMERFD_SETTIME equ 0x11e
SYSCALL_TIMERFD_GETTIME equ 0x11f
SYSCALL_ACCEPT4 equ 0x120
SYSCALL_SIGNALFD4 equ 0x121
SYSCALL_EVENTFD2 equ 0x122
SYSCALL_EPOLL_CREATE1 equ 0x123
SYSCALL_DUP3 equ 0x124
SYSCALL_PIPE2 equ 0x125
SYSCALL_INOTIFY_INIT1 equ 0x126
SYSCALL_PREADV equ 0x127
SYSCALL_PWRITEV equ 0x128
SYSCALL_RT_TGSIGQUEUEINFO equ 0x129
SYSCALL_PERF_EVENT_OPEN equ 0x12a
SYSCALL_RECVMMSG equ 0x12b
SYSCALL_FANOTIFY_INIT equ 0x12c
SYSCALL_FANOTIFY_MARK equ 0x12d
SYSCALL_PRLIMIT64 equ 0x12e
SYSCALL_NAME_TO_HANDLE_AT equ 0x12f
SYSCALL_OPEN_BY_HANDLE_AT equ 0x130
SYSCALL_CLOCK_ADJTIME equ 0x131
SYSCALL_SYNCFS equ 0x132
SYSCALL_SENDMMSG equ 0x133
SYSCALL_SETNS equ 0x134
SYSCALL_GETCPU equ 0x135
SYSCALL_PROCESS_VM_READV equ 0x136
SYSCALL_PROCESS_VM_WRITEV equ 0x137
SYSCALL_KCMP equ 0x138
SYSCALL_FINIT_MODULE equ 0x139
SYSCALL_SCHED_SETATTR equ 0x13a
SYSCALL_SCHED_GETATTR equ 0x13b
SYSCALL_RENAMEAT2 equ 0x13c
SYSCALL_SECCOMP equ 0x13d
SYSCALL_GETRANDOM equ 0x13e
SYSCALL_MEMFD_CREATE equ 0x13f
SYSCALL_KEXEC_FILE_LOAD equ 0x140
SYSCALL_BPF equ 0x141
SYSCALL_EXECVEAT equ 0x142
SYSCALL_USERFAULTFD equ 0x143
SYSCALL_MEMBARRIER equ 0x144
SYSCALL_MLOCK2 equ 0x145
SYSCALL_COPY_FILE_RANGE equ 0x146
SYSCALL_PREADV2 equ 0x147
SYSCALL_PWRITEV2 equ 0x148
SYSCALL_PKEY_MPROTECT equ 0x149
SYSCALL_PKEY_ALLOC equ 0x14a
SYSCALL_PKEY_FREE equ 0x14b
SYSCALL_STATX equ 0x14c

macro exit c {
  mov rax, SYSCALL_EXIT
  mov rdi, c
  syscall
}


macro write fd, string, strlen {
  pusha64
  mov rdx, strlen
  mov rsi, string
  mov rdi, fd
  mov rax, SYSCALL_WRITE
  syscall
  popa64
}


